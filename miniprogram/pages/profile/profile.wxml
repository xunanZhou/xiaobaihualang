<!--pages/profile/profile.wxml-->
<view class="profile-container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="custom-navbar">
    <view class="navbar-content">
      <text class="navbar-title">æˆ‘çš„</text>
      <view class="navbar-settings" bindtap="onSettingsTap" wx:if="{{isLoggedIn}}">
        <t-icon name="setting" size="40rpx" color="#666666" />
      </view>
    </view>
  </view>

  <!-- ä¸»å†…å®¹åŒºåŸŸ -->
  <view class="page-content">
    <!-- æœªç™»å½•çŠ¶æ€ -->
    <view class="unlogged-state" wx:if="{{!isLoggedIn}}">
      <!-- æ¬¢è¿åŒºåŸŸ -->
      <view class="welcome-card card">
        <view class="welcome-content">
          <view class="welcome-icon float-animation">
            <text class="icon-text">ğŸ¨</text>
          </view>
          <text class="welcome-title gradient-text">æ¬¢è¿æ¥åˆ°AIç”»å»Š</text>
          <text class="welcome-desc">å‘ç°æ— é™åˆ›æ„å¯èƒ½\nç”¨AIåˆ›ä½œå±äºä½ çš„è‰ºæœ¯ä½œå“</text>
          
          <t-button 
            theme="primary" 
            size="large"
            class="login-btn"
            bindtap="onLoginTap"
          >
            <t-icon name="wechat" size="32rpx" slot="icon" />
            å¾®ä¿¡ä¸€é”®ç™»å½•
          </t-button>
          
          <text class="login-tips">ç™»å½•å³è¡¨ç¤ºåŒæ„ã€Šç”¨æˆ·åè®®ã€‹å’Œã€Šéšç§æ”¿ç­–ã€‹</text>
        </view>
      </view>

      <!-- åŠŸèƒ½ä»‹ç» -->
      <view class="features-card card">
        <view class="card-header">
          <t-icon name="lightning" size="32rpx" color="#0052d9" />
          <text class="card-title">ç™»å½•åå¯äº«å—</text>
        </view>
        
        <t-grid column="{{2}}" class="features-grid">
          <t-grid-item 
            wx:for="{{features}}" 
            wx:key="id"
            class="feature-item"
            bindtap="onFeatureTap"
            data-feature="{{item}}"
          >
            <view class="feature-content">
              <view class="feature-icon" style="background: {{item.bgColor}}">
                <text class="feature-emoji">{{item.icon}}</text>
              </view>
              <text class="feature-title">{{item.title}}</text>
              <text class="feature-desc">{{item.desc}}</text>
            </view>
          </t-grid-item>
        </t-grid>
      </view>

      <!-- çƒ­é—¨ä½œå“é¢„è§ˆ -->
      <view class="preview-card card">
        <view class="card-header">
          <t-icon name="heart-filled" size="32rpx" color="#ff4757" />
          <text class="card-title">çƒ­é—¨ä½œå“</text>
        </view>
        
        <view class="preview-grid">
          <view 
            class="preview-item" 
            wx:for="{{previewArtworks}}" 
            wx:key="id"
            bindtap="onPreviewTap"
          >
            <view class="preview-placeholder" style="background: {{item.color}}">
              <text class="preview-text">{{item.title}}</text>
            </view>
          </view>
        </view>
        
        <view class="preview-footer">
          <text class="preview-tip">ç™»å½•æŸ¥çœ‹æ›´å¤šç²¾å½©ä½œå“</text>
          <t-button 
            theme="light" 
            size="small"
            bindtap="onLoginTap"
          >
            ç«‹å³ä½“éªŒ â†’
          </t-button>
        </view>
      </view>

      <!-- åˆ›ä½œçµæ„Ÿ -->
      <view class="inspiration-card card">
        <view class="card-header">
          <t-icon name="lightbulb" size="32rpx" color="#ffa726" />
          <text class="card-title">åˆ›ä½œçµæ„Ÿ</text>
        </view>
        
        <view class="inspiration-list">
          <view 
            class="inspiration-item" 
            wx:for="{{inspirations}}" 
            wx:key="id"
          >
            <view class="inspiration-icon">{{item.emoji}}</view>
            <view class="inspiration-content">
              <text class="inspiration-title">{{item.title}}</text>
              <text class="inspiration-desc">{{item.desc}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- å·²ç™»å½•çŠ¶æ€ -->
    <view class="logged-state" wx:else>
      <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
      <view class="user-card card">
        <view class="user-info">
          <t-avatar 
            size="large" 
            image="{{userInfo.avatarUrl}}" 
            class="user-avatar"
          />
          <view class="user-details">
            <text class="user-name">{{userInfo.nickName}}</text>
            <text class="user-role">AIè‰ºæœ¯åˆ›ä½œè€…</text>
          </view>
        </view>
        
        <!-- ç»Ÿè®¡æ•°æ® -->
        <view class="user-stats">
          <view class="stat-item">
            <text class="stat-number">{{userStats.artworks}}</text>
            <text class="stat-label">ä½œå“</text>
          </view>
          <view class="stat-item">
            <text class="stat-number">{{userStats.likes}}</text>
            <text class="stat-label">è·èµ</text>
          </view>
          <view class="stat-item">
            <text class="stat-number">{{userStats.days}}</text>
            <text class="stat-label">å¤©</text>
          </view>
        </view>
        
        <!-- æˆå°±å¾½ç«  -->
        <view class="achievements" wx:if="{{achievements.length > 0}}">
          <t-tag 
            wx:for="{{achievements}}" 
            wx:key="*this"
            size="small" 
            variant="light"
            theme="{{item.theme}}"
            class="achievement-tag"
          >
            {{item.name}}
          </t-tag>
        </view>
      </view>

      <!-- å¿«æ·æ“ä½œ -->
      <view class="actions-card card">
        <t-grid column="{{4}}" class="actions-grid">
          <t-grid-item 
            wx:for="{{quickActions}}" 
            wx:key="id"
            class="action-item"
            bindtap="onActionTap"
            data-action="{{item}}"
          >
            <view class="action-content">
              <view class="action-icon" style="background: {{item.bgColor}}">
                <t-icon name="{{item.icon}}" size="40rpx" color="{{item.iconColor}}" />
              </view>
              <text class="action-label">{{item.label}}</text>
            </view>
          </t-grid-item>
        </t-grid>
      </view>

      <!-- ä¸ªäººç”»å»Š -->
      <view class="gallery-card card">
        <view class="card-header">
          <text class="card-title">ä¸ªäººç”»å»Š</text>
          <t-button 
            theme="light" 
            size="small"
            bindtap="onViewAllTap"
            wx:if="{{userArtworks.length > 4}}"
          >
            æŸ¥çœ‹å…¨éƒ¨
          </t-button>
        </view>
        
        <!-- ä½œå“ç½‘æ ¼ -->
        <view class="gallery-grid" wx:if="{{userArtworks.length > 0}}">
          <view 
            class="gallery-item" 
            wx:for="{{displayArtworks}}" 
            wx:key="id"
            bindtap="onArtworkTap"
            data-artwork="{{item}}"
          >
            <t-image 
              src="{{item.imageUrl}}" 
              mode="aspectFill"
              class="gallery-image"
              loading="{{true}}"
              error="{{true}}"
            />
            <view class="gallery-info">
              <text class="gallery-title">{{item.prompt}}</text>
              <view class="gallery-meta">
                <text class="gallery-date">{{item.timeAgo}}</text>
                <view class="gallery-likes">
                  <t-icon name="heart-filled" size="20rpx" color="#ff4757" />
                  <text class="likes-count">{{item.likes}}</text>
                </view>
              </view>
            </view>
          </view>
        </view>
        
        <!-- ç©ºçŠ¶æ€ -->
        <view class="gallery-empty" wx:else>
          <view class="empty-icon">ğŸ–¼ï¸</view>
          <text class="empty-title">è¿˜æ²¡æœ‰ä½œå“</text>
          <text class="empty-desc">å¿«å»åˆ›ä½œä½ çš„ç¬¬ä¸€ä¸ªAIç”»ä½œå§ï¼</text>
          <t-button 
            theme="primary" 
            size="medium"
            class="create-btn"
            bindtap="onCreateTap"
          >
            å¼€å§‹åˆ›ä½œ
          </t-button>
        </view>
      </view>
    </view>
  </view>
</view>

<!-- Toast æç¤º -->
<t-toast id="t-toast" />

<!-- ç™»å½•å¼¹çª— -->
<t-dialog
  visible="{{showLoginDialog}}"
  title="å¾®ä¿¡ç™»å½•"
  content="æ˜¯å¦ä½¿ç”¨å¾®ä¿¡è´¦å·ç™»å½•AIç”»å»Šï¼Ÿ"
  confirm-btn="ç¡®è®¤ç™»å½•"
  cancel-btn="å–æ¶ˆ"
  bind:confirm="onConfirmLogin"
  bind:cancel="onCancelLogin"
/> 