<!--pages/profile/profile.wxml-->
<view class="profile-container">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="custom-navbar">
    <view class="navbar-content">
      <text class="navbar-title">æˆ‘çš„</text>
    </view>
  </view>

  <!-- ä¸»å†…å®¹åŒºåŸŸ -->
  <view class="page-content">
    <!-- æœªç™»å½•çŠ¶æ€ -->
    <view class="unlogged-state" wx:if="{{!isLoggedIn}}">
      <!-- æ¬¢è¿åŒºåŸŸ -->
      <view class="welcome-card card">
        <view class="welcome-content">
          <view class="welcome-icon">
            <text class="icon-text">ğŸ¨</text>
          </view>
          <text class="welcome-title">æ¬¢è¿æ¥åˆ°AIç”»å»Š</text>
          <text class="welcome-desc">å‘ç°æ— é™åˆ›æ„å¯èƒ½\nç”¨AIåˆ›ä½œå±äºä½ çš„è‰ºæœ¯ä½œå“</text>
          
          <view class="login-btn" bindtap="onLoginTap">
            å¾®ä¿¡ä¸€é”®ç™»å½•
          </view>
          
          <text class="login-tips">ç™»å½•å³è¡¨ç¤ºåŒæ„ã€Šç”¨æˆ·åè®®ã€‹å’Œã€Šéšç§æ”¿ç­–ã€‹</text>
        </view>
      </view>

      <!-- åŠŸèƒ½ä»‹ç» -->
      <view class="features-card card">
        <view class="card-header">
          <text class="card-title">ç™»å½•åå¯äº«å—</text>
        </view>
        
        <view class="features-grid">
          <view class="feature-item" wx:for="{{features}}" wx:key="id">
            <view class="feature-content">
              <view class="feature-icon">
                <text class="feature-emoji">{{item.icon}}</text>
              </view>
              <text class="feature-title">{{item.title}}</text>
              <text class="feature-desc">{{item.desc}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- å·²ç™»å½•çŠ¶æ€ -->
    <view class="logged-state" wx:else>
      <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
      <view class="user-card card">
        <view class="user-info">
          <image 
            src="{{userInfo.avatarUrl}}" 
            class="user-avatar"
          />
          <view class="user-details">
            <text class="user-name">{{userInfo.nickName}}</text>
            <text class="user-role">AIè‰ºæœ¯åˆ›ä½œè€…</text>
          </view>
        </view>
        
        <!-- ç»Ÿè®¡æ•°æ® -->
        <view class="user-stats">
          <view class="stat-item">
            <text class="stat-number">{{userStats.artworks}}</text>
            <text class="stat-label">ä½œå“</text>
          </view>
          <view class="stat-item">
            <text class="stat-number">{{userStats.likes}}</text>
            <text class="stat-label">è·èµ</text>
          </view>
          <view class="stat-item">
            <text class="stat-number">{{userStats.days}}</text>
            <text class="stat-label">å¤©</text>
          </view>
        </view>
      </view>

      <!-- å¿«æ·æ“ä½œ -->
      <view class="actions-card card">
        <view class="actions-grid">
          <view class="action-item" wx:for="{{quickActions}}" wx:key="id" bindtap="onActionTap" data-action="{{item}}">
            <view class="action-content">
              <view class="action-icon">
                <text class="action-emoji">{{item.icon}}</text>
              </view>
              <text class="action-label">{{item.label}}</text>
            </view>
          </view>
        </view>
      </view>

      <!-- ä¸ªäººç”»å»Š -->
      <view class="gallery-card card">
        <view class="card-header">
          <text class="card-title">ä¸ªäººç”»å»Š</text>
        </view>
        
        <view class="gallery-grid" wx:if="{{userArtworks.length > 0}}">
          <view class="gallery-item" wx:for="{{userArtworks}}" wx:key="id" bindtap="onArtworkTap" data-artwork="{{item}}">
            <image src="{{item.imageUrl}}" class="gallery-image" mode="aspectFill" />
            <view class="gallery-info">
              <text class="gallery-title">{{item.prompt}}</text>
              <text class="gallery-time">{{item.timeAgo}}</text>
            </view>
          </view>
        </view>
        
        <view class="empty-gallery" wx:else>
          <text class="empty-text">è¿˜æ²¡æœ‰ä½œå“</text>
          <text class="empty-desc">å¿«å»åˆ›ä½œç¬¬ä¸€ä¸ªAIç”»ä½œå§ï¼</text>
          <view class="create-btn" bindtap="onCreateTap">
            å¼€å§‹åˆ›ä½œ
          </view>
        </view>
      </view>
    </view>
  </view>
</view>

<!-- Toast æç¤º -->
<t-toast id="t-toast" />

<!-- ç™»å½•å¼¹çª— -->
<t-dialog
  visible="{{showLoginDialog}}"
  title="å¾®ä¿¡ç™»å½•"
  content="æ˜¯å¦ä½¿ç”¨å¾®ä¿¡è´¦å·ç™»å½•AIç”»å»Šï¼Ÿ"
  confirm-btn="ç¡®è®¤ç™»å½•"
  cancel-btn="å–æ¶ˆ"
  bind:confirm="onConfirmLogin"
  bind:cancel="onCancelLogin"
/> 